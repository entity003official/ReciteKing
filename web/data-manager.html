<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ•°æ®ç®¡ç† - æ—¥è¯­å•è¯èƒŒè¯µç‹</title>
    <style>
        body { font-family: 'Segoe UI',sans-serif; background: #f7f7fb; margin: 0; }
        .container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px #0001; padding: 32px; }
        h1 { margin-bottom: 16px; }
        .lesson-block { border: 1px solid #eee; border-radius: 8px; margin-bottom: 24px; padding: 16px; }
        .lesson-title { font-size: 1.2em; margin-bottom: 8px; }
        .column-block { background: #f5f5fa; border-radius: 6px; margin-bottom: 12px; padding: 12px; }
        .column-title { font-weight: bold; }
        .word-list { margin: 8px 0 0 0; }
        .word-list input { width: 120px; margin-right: 8px; }
        .btn { background: #667eea; color: #fff; border: none; border-radius: 4px; padding: 6px 16px; cursor: pointer; margin-right: 8px;}
        .btn-del { background: #ff6b6b; }
        .btn-export { background: #ffd93d; color: #333; }
        .nav-header { background: #fff; border-bottom: 1px solid #eee; padding: 12px 0; margin-bottom: 24px; }
        .nav-links a { margin-right: 18px; text-decoration: none; color: #667eea; font-weight: bold; }
        .nav-links a.active { color: #ff6b6b; }
        @media (max-width: 600px) {
            .container { padding: 8px; }
            .lesson-block { padding: 8px; }
        }
    </style>
</head>
<body>
    <nav class="nav-header">
        <div class="nav-links">
            <a href="index.html">ğŸ  é¦–é¡µ</a>
            <a href="word-typing.html">âœï¸ å•è¯è¾“å…¥</a>
            <a href="curriculum-selection.html">ğŸ“š è¯¾ç¨‹ç»ƒä¹ </a>
            <a href="curriculum-stats.html">ğŸ“Š è¯¾ç¨‹ç»Ÿè®¡</a>
            <a href="data-manager.html" class="active">ğŸ”§ æ•°æ®ç®¡ç†</a>
        </div>
    </nav>
    <div class="container">
        <h1>æ•°æ®ç®¡ç†ï¼ˆè¯¾ç¨‹/æ ç›®/å•è¯ï¼‰</h1>
        <div id="lessons"></div>
        <button class="btn" onclick="addLesson()">â• æ·»åŠ è¯¾ç¨‹</button>
        <button class="btn" onclick="loadSampleData()">ğŸ“‹ åŠ è½½ç¤ºä¾‹æ•°æ®</button>
        <button class="btn" onclick="loadAllLessons()">ğŸ“š åŠ è½½å…¨éƒ¨è¯¾ç¨‹</button>
        <button class="btn" onclick="loadCompleteBook()">ğŸ“– å®Œæ•´æ•™æ</button>
        <button class="btn btn-export" onclick="exportCSV()">ğŸ“¥ å¯¼å‡ºä¸ºCSV</button>
    </div>
    <script>
        // æ•°æ®ç»“æ„ï¼š[{lesson:'ç¬¬å››è¯¾', columns:[{name:'æ˜ŸæœŸ', words:[{kana:'', kanji:'', meaning:''}, ...]}, ...]}, ...]
        let data = [];

        function render() {
            const lessonsDiv = document.getElementById('lessons');
            lessonsDiv.innerHTML = '';
            data.forEach((lesson, li) => {
                const lessonDiv = document.createElement('div');
                lessonDiv.className = 'lesson-block';
                lessonDiv.innerHTML = `
                    <div class="lesson-title">
                        è¯¾ç¨‹ï¼š<input value="${lesson.lesson}" onchange="data[${li}].lesson=this.value;render()">
                        <button class="btn btn-del" onclick="delLesson(${li})">åˆ é™¤è¯¾ç¨‹</button>
                        <button class="btn" onclick="addColumn(${li})">â• æ·»åŠ æ ç›®</button>
                    </div>
                `;
                lesson.columns.forEach((col, ci) => {
                    const colDiv = document.createElement('div');
                    colDiv.className = 'column-block';
                    colDiv.innerHTML = `
                        <div class="column-title">
                            æ ç›®ï¼š<input value="${col.name}" onchange="data[${li}].columns[${ci}].name=this.value;render()">
                            <button class="btn btn-del" onclick="delColumn(${li},${ci})">åˆ é™¤æ ç›®</button>
                            <button class="btn" onclick="addWord(${li},${ci})">â• æ·»åŠ å•è¯</button>
                            <button class="btn" onclick="batchAddWords(${li},${ci})">æ‰¹é‡æ·»åŠ </button>
                        </div>
                        <div class="word-list" id="word-list-${li}-${ci}"></div>
                    `;
                    lessonDiv.appendChild(colDiv);
                    setTimeout(() => renderWords(li, ci), 0);
                });
                lessonsDiv.appendChild(lessonDiv);
            });
        }

        function renderWords(li, ci) {
            const wordDiv = document.getElementById(`word-list-${li}-${ci}`);
            wordDiv.innerHTML = '';
            data[li].columns[ci].words.forEach((w, wi) => {
                const row = document.createElement('div');
                row.innerHTML = `
                    å‡å: <input value="${w.kana}" onchange="data[${li}].columns[${ci}].words[${wi}].kana=this.value">
                    æ±‰å­—: <input value="${w.kanji}" onchange="data[${li}].columns[${ci}].words[${wi}].kanji=this.value">
                    é‡Šä¹‰: <input value="${w.meaning}" onchange="data[${li}].columns[${ci}].words[${wi}].meaning=this.value">
                    è¯æ€§: <select onchange="data[${li}].columns[${ci}].words[${wi}].pos=this.value">
                        <option value="åè¯" ${w.pos==='åè¯'?'selected':''}>åè¯</option>
                        <option value="åŠ¨è¯" ${w.pos==='åŠ¨è¯'?'selected':''}>åŠ¨è¯</option>
                        <option value="å½¢å®¹è¯" ${w.pos==='å½¢å®¹è¯'?'selected':''}>å½¢å®¹è¯</option>
                        <option value="å‰¯è¯" ${w.pos==='å‰¯è¯'?'selected':''}>å‰¯è¯</option>
                        <option value="åŠ©è¯" ${w.pos==='åŠ©è¯'?'selected':''}>åŠ©è¯</option>
                        <option value="å…¶ä»–" ${w.pos==='å…¶ä»–'?'selected':''}>å…¶ä»–</option>
                    </select>
                    <button class="btn btn-del" onclick="delWord(${li},${ci},${wi})">åˆ é™¤</button>
                `;
                wordDiv.appendChild(row);
            });
        }

        function addLesson() {
            data.push({lesson:'æ–°è¯¾ç¨‹', columns:[]});
            render();
        }
        function delLesson(i) {
            if(confirm('ç¡®å®šåˆ é™¤è¯¥è¯¾ç¨‹ï¼Ÿ')) { data.splice(i,1); render(); }
        }
        function addColumn(li) {
            data[li].columns.push({name:'æ–°æ ç›®', words:[]});
            render();
        }
        function delColumn(li,ci) {
            if(confirm('ç¡®å®šåˆ é™¤è¯¥æ ç›®ï¼Ÿ')) { data[li].columns.splice(ci,1); render(); }
        }
        function addWord(li,ci) {
            data[li].columns[ci].words.push({kana:'', kanji:'', meaning:'', pos:'åè¯'});
            render();
        }
        function delWord(li,ci,wi) {
            data[li].columns[ci].words.splice(wi,1);
            render();
        }
        // æ‰¹é‡æ·»åŠ å•è¯
        function batchAddWords(li,ci) {
            const text = prompt('æ¯è¡Œæ ¼å¼ï¼šå‡å,æ±‰å­—,é‡Šä¹‰,è¯æ€§\nå¦‚ï¼šãã®ã†,æ˜¨æ—¥,æ˜¨å¤©,åè¯\n\nå¯ä»¥ä¸€æ¬¡æ·»åŠ å¤šè¡Œï¼š');
            if(!text) return;
            text.split('\n').forEach(line => {
                line = line.trim();
                if(line) {
                    const arr = line.split(',');
                    if(arr.length >= 3) {
                        data[li].columns[ci].words.push({
                            kana: arr[0].trim(), 
                            kanji: arr[1].trim(), 
                            meaning: arr[2].trim(),
                            pos: arr[3] ? arr[3].trim() : 'åè¯'
                        });
                    }
                }
            });
            render();
        }
        // å¯¼å‡ºä¸ºCSV
        function exportCSV() {
            let csv = 'è¯¾ç¨‹,æ ç›®,å‡å,æ±‰å­—,é‡Šä¹‰,è¯æ€§\n';
            data.forEach(lesson => {
                lesson.columns.forEach(col => {
                    col.words.forEach(w => {
                        csv += `"${lesson.lesson}","${col.name}","${w.kana}","${w.kanji}","${w.meaning}","${w.pos||'åè¯'}"\n`;
                    });
                });
            });
            const blob = new Blob([csv], {type:'text/csv'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'japanese_words_custom.csv';
            a.click();
        }
        
        // åŠ è½½ç¤ºä¾‹æ•°æ®
        function loadSampleData() {
            if(data.length > 0 && !confirm('è¿™å°†è¦†ç›–ç°æœ‰æ•°æ®ï¼Œç¡®å®šç»§ç»­ï¼Ÿ')) return;
            
            data = [
                {
                    lesson: 'ç¬¬å››è¯¾',
                    columns: [
                        {
                            name: 'æ˜ŸæœŸ',
                            words: [
                                {kana: 'ãªã‚“ã‚ˆã†ã³', kanji: 'ä½•æ›œæ—¥', meaning: 'æ˜ŸæœŸå‡ ', pos: 'åè¯'},
                                {kana: 'ã’ã¤ã‚ˆã†ã³', kanji: 'æœˆæ›œæ—¥', meaning: 'æ˜ŸæœŸä¸€', pos: 'åè¯'},
                                {kana: 'ã‹ã‚ˆã†ã³', kanji: 'ç«æ›œæ—¥', meaning: 'æ˜ŸæœŸäºŒ', pos: 'åè¯'},
                                {kana: 'ã™ã„ã‚ˆã†ã³', kanji: 'æ°´æ›œæ—¥', meaning: 'æ˜ŸæœŸä¸‰', pos: 'åè¯'},
                                {kana: 'ã‚‚ãã‚ˆã†ã³', kanji: 'æœ¨æ›œæ—¥', meaning: 'æ˜ŸæœŸå››', pos: 'åè¯'},
                                {kana: 'ãã‚“ã‚ˆã†ã³', kanji: 'é‡‘æ›œæ—¥', meaning: 'æ˜ŸæœŸäº”', pos: 'åè¯'},
                                {kana: 'ã©ã‚ˆã†ã³', kanji: 'åœŸæ›œæ—¥', meaning: 'æ˜ŸæœŸå…­', pos: 'åè¯'},
                                {kana: 'ã«ã¡ã‚ˆã†ã³', kanji: 'æ—¥æ›œæ—¥', meaning: 'æ˜ŸæœŸæ—¥', pos: 'åè¯'}
                            ]
                        },
                        {
                            name: 'æ—¶é—´æ¦‚å¿µï¼ˆå¤©ï¼‰',
                            words: [
                                {kana: 'ãã®ã†', kanji: 'æ˜¨æ—¥', meaning: 'æ˜¨å¤©', pos: 'åè¯'},
                                {kana: 'ãŠã¨ã¨ã„', kanji: 'ä¸€æ˜¨æ—¥', meaning: 'å‰å¤©', pos: 'åè¯'},
                                {kana: 'ãã‚‡ã†', kanji: 'ä»Šæ—¥', meaning: 'ä»Šå¤©', pos: 'åè¯'},
                                {kana: 'ã‚ã—ãŸ', kanji: 'æ˜æ—¥', meaning: 'æ˜å¤©', pos: 'åè¯'},
                                {kana: 'ã‚ã•ã£ã¦', kanji: 'æ˜å¾Œæ—¥', meaning: 'åå¤©', pos: 'åè¯'}
                            ]
                        },
                        {
                            name: 'æ—¶é—´æ¦‚å¿µï¼ˆä¸€å¤©å†…ï¼‰',
                            words: [
                                {kana: 'ã”ãœã‚“', kanji: 'åˆå‰', meaning: 'ä¸Šåˆ', pos: 'åè¯'},
                                {kana: 'ã”ã”', kanji: 'åˆå¾Œ', meaning: 'ä¸‹åˆ', pos: 'åè¯'},
                                {kana: 'ã‚ã•', kanji: 'æœ', meaning: 'æ—©æ™¨', pos: 'åè¯'},
                                {kana: 'ã°ã‚“', kanji: 'æ™©', meaning: 'æ™šä¸Š', pos: 'åè¯'},
                                {kana: 'ã²ã‚‹', kanji: 'æ˜¼', meaning: 'ç™½å¤©', pos: 'åè¯'}
                            ]
                        },
                        {
                            name: 'æ—¥å¸¸åŠ¨ä½œ',
                            words: [
                                {kana: 'ãŠãã¾ã™', kanji: 'èµ·ãã¾ã™', meaning: 'èµ·åºŠ', pos: 'åŠ¨è¯'},
                                {kana: 'ã­ã¾ã™', kanji: 'å¯ã¾ã™', meaning: 'ç¡è§‰', pos: 'åŠ¨è¯'},
                                {kana: 'ãŸã¹ã¾ã™', kanji: 'é£Ÿã¹ã¾ã™', meaning: 'åƒ', pos: 'åŠ¨è¯'},
                                {kana: 'ã®ã¿ã¾ã™', kanji: 'é£²ã¿ã¾ã™', meaning: 'å–', pos: 'åŠ¨è¯'}
                            ]
                        },
                        {
                            name: 'ç§»åŠ¨åŠ¨ä½œ',
                            words: [
                                {kana: 'ã„ãã¾ã™', kanji: 'è¡Œãã¾ã™', meaning: 'å»', pos: 'åŠ¨è¯'},
                                {kana: 'ãã¾ã™', kanji: 'æ¥ã¾ã™', meaning: 'æ¥', pos: 'åŠ¨è¯'},
                                {kana: 'ã‹ãˆã‚Šã¾ã™', kanji: 'å¸°ã‚Šã¾ã™', meaning: 'å›æ¥', pos: 'åŠ¨è¯'}
                            ]
                        },
                        {
                            name: 'åœºæ‰€ä¸ç‰©å“',
                            words: [
                                {kana: 'ãŒã£ã“ã†', kanji: 'å­¦æ ¡', meaning: 'å­¦æ ¡', pos: 'åè¯'},
                                {kana: 'ã„ãˆ', kanji: 'å®¶', meaning: 'å®¶', pos: 'åè¯'},
                                {kana: 'ã‹ã„ã—ã‚ƒ', kanji: 'ä¼šç¤¾', meaning: 'å…¬å¸', pos: 'åè¯'},
                                {kana: 'ã¿ãš', kanji: 'æ°´', meaning: 'æ°´', pos: 'åè¯'},
                                {kana: 'ã”ã¯ã‚“', kanji: 'ã”é£¯', meaning: 'ç±³é¥­', pos: 'åè¯'},
                                {kana: 'ã»ã‚“', kanji: 'æœ¬', meaning: 'ä¹¦', pos: 'åè¯'},
                                {kana: 'ã§ã‚“ã—ã‚ƒ', kanji: 'é›»è»Š', meaning: 'ç”µè½¦', pos: 'åè¯'}
                            ]
                        }
                    ]
                }
            ];
            render();
            alert('ç¤ºä¾‹æ•°æ®å·²åŠ è½½ï¼å·²æ·»åŠ è¯æ€§å­—æ®µï¼Œå¹¶é‡æ–°æ•´åˆäº†æ ç›®åˆ†ç±»');
        }
        
        // åŠ è½½å…¨éƒ¨è¯¾ç¨‹æ•°æ®
        function loadAllLessons() {
            if(data.length > 0 && !confirm('è¿™å°†è¦†ç›–ç°æœ‰æ•°æ®ï¼Œç¡®å®šç»§ç»­ï¼Ÿ')) return;
            
            data = [
                // ç¬¬ä¸€è¯¾æ•°æ®
                {
                    lesson: 'ç¬¬ä¸€è¯¾',
                    columns: [
                        {
                            name: 'äººç§°ä»£è¯',
                            words: [
                                {kana: 'ã‚ãŸã—', kanji: 'ç§', meaning: 'æˆ‘', pos: 'ä»£è¯'},
                                {kana: 'ã‚ãªãŸ', kanji: 'ã‚ãªãŸ', meaning: 'ä½ ', pos: 'ä»£è¯'},
                                {kana: 'ã‚ã®ã²ã¨', kanji: 'ã‚ã®äºº', meaning: 'é‚£ä¸ªäºº', pos: 'ä»£è¯'}
                            ]
                        },
                        {
                            name: 'å›½ç±ä¸èŒä¸š',
                            words: [
                                {kana: 'ãŒãã›ã„', kanji: 'å­¦ç”Ÿ', meaning: 'å­¦ç”Ÿ', pos: 'åè¯'},
                                {kana: 'ã›ã‚“ã›ã„', kanji: 'å…ˆç”Ÿ', meaning: 'è€å¸ˆ', pos: 'åè¯'},
                                {kana: 'ã‹ã„ã—ã‚ƒã„ã‚“', kanji: 'ä¼šç¤¾å“¡', meaning: 'å…¬å¸èŒå‘˜', pos: 'åè¯'},
                                {kana: 'ã¡ã‚…ã†ã”ãã˜ã‚“', kanji: 'ä¸­å›½äºº', meaning: 'ä¸­å›½äºº', pos: 'åè¯'},
                                {kana: 'ã«ã»ã‚“ã˜ã‚“', kanji: 'æ—¥æœ¬äºº', meaning: 'æ—¥æœ¬äºº', pos: 'åè¯'}
                            ]
                        }
                    ]
                },
                // ç¬¬å››è¯¾æ•°æ®(ä¿ç•™åŸæœ‰)
                {
                    lesson: 'ç¬¬å››è¯¾',
                    columns: [
                        {
                            name: 'æ˜ŸæœŸ',
                            words: [
                                {kana: 'ãªã‚“ã‚ˆã†ã³', kanji: 'ä½•æ›œæ—¥', meaning: 'æ˜ŸæœŸå‡ ', pos: 'åè¯'},
                                {kana: 'ã’ã¤ã‚ˆã†ã³', kanji: 'æœˆæ›œæ—¥', meaning: 'æ˜ŸæœŸä¸€', pos: 'åè¯'},
                                {kana: 'ã‹ã‚ˆã†ã³', kanji: 'ç«æ›œæ—¥', meaning: 'æ˜ŸæœŸäºŒ', pos: 'åè¯'},
                                {kana: 'ã™ã„ã‚ˆã†ã³', kanji: 'æ°´æ›œæ—¥', meaning: 'æ˜ŸæœŸä¸‰', pos: 'åè¯'},
                                {kana: 'ã‚‚ãã‚ˆã†ã³', kanji: 'æœ¨æ›œæ—¥', meaning: 'æ˜ŸæœŸå››', pos: 'åè¯'},
                                {kana: 'ãã‚“ã‚ˆã†ã³', kanji: 'é‡‘æ›œæ—¥', meaning: 'æ˜ŸæœŸäº”', pos: 'åè¯'},
                                {kana: 'ã©ã‚ˆã†ã³', kanji: 'åœŸæ›œæ—¥', meaning: 'æ˜ŸæœŸå…­', pos: 'åè¯'},
                                {kana: 'ã«ã¡ã‚ˆã†ã³', kanji: 'æ—¥æ›œæ—¥', meaning: 'æ˜ŸæœŸæ—¥', pos: 'åè¯'}
                            ]
                        },
                        {
                            name: 'æ—¶é—´æ¦‚å¿µï¼ˆå¤©ï¼‰',
                            words: [
                                {kana: 'ãã®ã†', kanji: 'æ˜¨æ—¥', meaning: 'æ˜¨å¤©', pos: 'åè¯'},
                                {kana: 'ãŠã¨ã¨ã„', kanji: 'ä¸€æ˜¨æ—¥', meaning: 'å‰å¤©', pos: 'åè¯'},
                                {kana: 'ãã‚‡ã†', kanji: 'ä»Šæ—¥', meaning: 'ä»Šå¤©', pos: 'åè¯'},
                                {kana: 'ã‚ã—ãŸ', kanji: 'æ˜æ—¥', meaning: 'æ˜å¤©', pos: 'åè¯'},
                                {kana: 'ã‚ã•ã£ã¦', kanji: 'æ˜å¾Œæ—¥', meaning: 'åå¤©', pos: 'åè¯'}
                            ]
                        }
                    ]
                },
                // ç¬¬å…­è¯¾æ•°æ®
                {
                    lesson: 'ç¬¬å…­è¯¾',
                    columns: [
                        {
                            name: 'æ—¥å¸¸åŠ¨ä½œ',
                            words: [
                                {kana: 'ãŸã¹ã¾ã™', kanji: 'é£Ÿã¹ã¾ã™', meaning: 'åƒ', pos: 'åŠ¨è¯'},
                                {kana: 'ã®ã¿ã¾ã™', kanji: 'é£²ã¿ã¾ã™', meaning: 'å–', pos: 'åŠ¨è¯'},
                                {kana: 'ã¿ã¾ã™', kanji: 'è¦‹ã¾ã™', meaning: 'çœ‹', pos: 'åŠ¨è¯'},
                                {kana: 'ããã¾ã™', kanji: 'èãã¾ã™', meaning: 'å¬', pos: 'åŠ¨è¯'}
                            ]
                        },
                        {
                            name: 'é£Ÿç‰©é¥®æ–™',
                            words: [
                                {kana: 'ã”ã¯ã‚“', kanji: 'ã”é£¯', meaning: 'ç±³é¥­', pos: 'åè¯'},
                                {kana: 'ã¿ãš', kanji: 'æ°´', meaning: 'æ°´', pos: 'åè¯'},
                                {kana: 'ãŠã¡ã‚ƒ', kanji: 'ãŠèŒ¶', meaning: 'èŒ¶', pos: 'åè¯'},
                                {kana: 'ã‚³ãƒ¼ãƒ’ãƒ¼', kanji: 'ã‚³ãƒ¼ãƒ’ãƒ¼', meaning: 'å’–å•¡', pos: 'åè¯'}
                            ]
                        }
                    ]
                }
            ];
            render();
            alert('å…¨éƒ¨è¯¾ç¨‹æ•°æ®å·²åŠ è½½ï¼åŒ…å«ç¬¬1ã€4ã€6è¯¾çš„ç²¾é€‰è¯æ±‡å†…å®¹');
        }
        
        // åŠ è½½å®Œæ•´åˆçº§1æ•™ææ•°æ®
        function loadCompleteBook() {
            if(data.length > 0 && !confirm('è¿™å°†åŠ è½½å®Œæ•´çš„åˆçº§1æ•™ææ•°æ®ï¼Œç¡®å®šç»§ç»­ï¼Ÿ')) return;
            
            alert('åˆçº§1æ•™æåŒ…å«24è¯¾ï¼Œå…±780+ä¸ªå•è¯ã€‚æ•°æ®è¾ƒå¤§ï¼Œè¯·ç¨ç­‰...');
            // è¿™é‡Œå¯ä»¥æ·»åŠ å®Œæ•´çš„24è¯¾æ•°æ®
            // ç”±äºæ•°æ®é‡å¤§ï¼Œå»ºè®®åˆ†æ‰¹åŠ è½½æˆ–ä»CSVæ–‡ä»¶è¯»å–
            alert('å®Œæ•´æ•™ææ•°æ®åŠŸèƒ½å¼€å‘ä¸­ï¼Œè¯·ä½¿ç”¨CSVæ–‡ä»¶å¯¼å…¥åŠŸèƒ½');
        }
        
        render();
    </script>
</body>
</html>
