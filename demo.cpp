#include <iostream>
#include <map>
#include <vector>
#include <algorithm>
#include <ctime>
#include <cstdlib>

using namespace std;

// å‡åä¸ç½—é©¬éŸ³æ˜ å°„
map<string, string> kanaMap = {
    // å¹³å‡å
    {"ã‚", "a"}, {"ã„", "i"}, {"ã†", "u"}, {"ãˆ", "e"}, {"ãŠ", "o"},
    {"ã‹", "ka"}, {"ã", "ki"}, {"ã", "ku"}, {"ã‘", "ke"}, {"ã“", "ko"},
    {"ã•", "sa"}, {"ã—", "shi"}, {"ã™", "su"}, {"ã›", "se"}, {"ã", "so"},
    {"ãŸ", "ta"}, {"ã¡", "chi"}, {"ã¤", "tsu"}, {"ã¦", "te"}, {"ã¨", "to"},
    {"ãª", "na"}, {"ã«", "ni"}, {"ã¬", "nu"}, {"ã­", "ne"}, {"ã®", "no"},
    {"ã¯", "ha"}, {"ã²", "hi"}, {"ãµ", "fu"}, {"ã¸", "he"}, {"ã»", "ho"},
    {"ã¾", "ma"}, {"ã¿", "mi"}, {"ã‚€", "mu"}, {"ã‚", "me"}, {"ã‚‚", "mo"},
    {"ã‚„", "ya"}, {"ã‚†", "yu"}, {"ã‚ˆ", "yo"},
    {"ã‚‰", "ra"}, {"ã‚Š", "ri"}, {"ã‚‹", "ru"}, {"ã‚Œ", "re"}, {"ã‚", "ro"},
    {"ã‚", "wa"}, {"ã‚’", "wo"}, {"ã‚“", "n"},

    // ç‰‡å‡å
    {"ã‚¢", "a"}, {"ã‚¤", "i"}, {"ã‚¦", "u"}, {"ã‚¨", "e"}, {"ã‚ª", "o"},
    {"ã‚«", "ka"}, {"ã‚­", "ki"}, {"ã‚¯", "ku"}, {"ã‚±", "ke"}, {"ã‚³", "ko"},
    {"ã‚µ", "sa"}, {"ã‚·", "shi"}, {"ã‚¹", "su"}, {"ã‚»", "se"}, {"ã‚½", "so"},
    {"ã‚¿", "ta"}, {"ãƒ", "chi"}, {"ãƒ„", "tsu"}, {"ãƒ†", "te"}, {"ãƒˆ", "to"},
    {"ãƒŠ", "na"}, {"ãƒ‹", "ni"}, {"ãƒŒ", "nu"}, {"ãƒ", "ne"}, {"ãƒ", "no"},
    {"ãƒ", "ha"}, {"ãƒ’", "hi"}, {"ãƒ•", "fu"}, {"ãƒ˜", "he"}, {"ãƒ›", "ho"},
    {"ãƒ", "ma"}, {"ãƒŸ", "mi"}, {"ãƒ ", "mu"}, {"ãƒ¡", "me"}, {"ãƒ¢", "mo"},
    {"ãƒ¤", "ya"}, {"ãƒ¦", "yu"}, {"ãƒ¨", "yo"},
    {"ãƒ©", "ra"}, {"ãƒª", "ri"}, {"ãƒ«", "ru"}, {"ãƒ¬", "re"}, {"ãƒ­", "ro"},
    {"ãƒ¯", "wa"}, {"ãƒ²", "wo"}, {"ãƒ³", "n"},

    // æµŠéŸ³
    {"ãŒ", "ga"}, {"ã", "gi"}, {"ã", "gu"}, {"ã’", "ge"}, {"ã”", "go"},
    {"ã–", "za"}, {"ã˜", "ji"}, {"ãš", "zu"}, {"ãœ", "ze"}, {"ã", "zo"},
    {"ã ", "da"}, {"ã¢", "ji"}, {"ã¥", "zu"}, {"ã§", "de"}, {"ã©", "do"},
    {"ã°", "ba"}, {"ã³", "bi"}, {"ã¶", "bu"}, {"ã¹", "be"}, {"ã¼", "bo"},

    // ç‰‡å‡åæµŠéŸ³
    {"ã‚¬", "ga"}, {"ã‚®", "gi"}, {"ã‚°", "gu"}, {"ã‚²", "ge"}, {"ã‚´", "go"},
    {"ã‚¶", "za"}, {"ã‚¸", "ji"}, {"ã‚º", "zu"}, {"ã‚¼", "ze"}, {"ã‚¾", "zo"},
    {"ãƒ€", "da"}, {"ãƒ‚", "ji"}, {"ãƒ…", "zu"}, {"ãƒ‡", "de"}, {"ãƒ‰", "do"},
    {"ãƒ", "ba"}, {"ãƒ“", "bi"}, {"ãƒ–", "bu"}, {"ãƒ™", "be"}, {"ãƒœ", "bo"},

    // åŠæµŠéŸ³
    {"ã±", "pa"}, {"ã´", "pi"}, {"ã·", "pu"}, {"ãº", "pe"}, {"ã½", "po"},

    // ç‰‡å‡ååŠæµŠéŸ³
    {"ãƒ‘", "pa"}, {"ãƒ”", "pi"}, {"ãƒ—", "pu"}, {"ãƒš", "pe"}, {"ãƒ", "po"},

    // æ‹—éŸ³
    {"ãã‚ƒ", "kya"}, {"ãã‚…", "kyu"}, {"ãã‚‡", "kyo"},
    {"ã—ã‚ƒ", "sha"}, {"ã—ã‚…", "shu"}, {"ã—ã‚‡", "sho"},
    {"ã¡ã‚ƒ", "cha"}, {"ã¡ã‚…", "chu"}, {"ã¡ã‚‡", "cho"},
    {"ã«ã‚ƒ", "nya"}, {"ã«ã‚…", "nyu"}, {"ã«ã‚‡", "nyo"},
    {"ã²ã‚ƒ", "hya"}, {"ã²ã‚…", "hyu"}, {"ã²ã‚‡", "hyo"},
    {"ã¿ã‚ƒ", "mya"}, {"ã¿ã‚…", "myu"}, {"ã¿ã‚‡", "myo"},
    {"ã‚Šã‚ƒ", "rya"}, {"ã‚Šã‚…", "ryu"}, {"ã‚Šã‚‡", "ryo"},

    // ç‰‡å‡åæ‹—éŸ³
    {"ã‚­ãƒ£", "kya"}, {"ã‚­ãƒ¥", "kyu"}, {"ã‚­ãƒ§", "kyo"},
    {"ã‚·ãƒ£", "sha"}, {"ã‚·ãƒ¥", "shu"}, {"ã‚·ãƒ§", "sho"},
    {"ãƒãƒ£", "cha"}, {"ãƒãƒ¥", "chu"}, {"ãƒãƒ§", "cho"},
    {"ãƒ‹ãƒ£", "nya"}, {"ãƒ‹ãƒ¥", "nyu"}, {"ãƒ‹ãƒ§", "nyo"},
    {"ãƒ’ãƒ£", "hya"}, {"ãƒ’ãƒ¥", "hyu"}, {"ãƒ’ãƒ§", "hyo"},
    {"ãƒŸãƒ£", "mya"}, {"ãƒŸãƒ¥", "myu"}, {"ãƒŸãƒ§", "myo"},
    {"ãƒªãƒ£", "rya"}, {"ãƒªãƒ¥", "ryu"}, {"ãƒªãƒ§", "ryo"},

    // æµŠéŸ³æ‹—éŸ³
    {"ãã‚ƒ", "gya"}, {"ãã‚…", "gyu"}, {"ãã‚‡", "gyo"},
    {"ã˜ã‚ƒ", "ja"}, {"ã˜ã‚…", "ju"}, {"ã˜ã‚‡", "jo"},
    {"ã³ã‚ƒ", "bya"}, {"ã³ã‚…", "byu"}, {"ã³ã‚‡", "byo"},

    // ç‰‡å‡åæµŠéŸ³æ‹—éŸ³
    {"ã‚®ãƒ£", "gya"}, {"ã‚®ãƒ¥", "gyu"}, {"ã‚®ãƒ§", "gyo"},
    {"ã‚¸ãƒ£", "ja"}, {"ã‚¸ãƒ¥", "ju"}, {"ã‚¸ãƒ§", "jo"},
    {"ãƒ“ãƒ£", "bya"}, {"ãƒ“ãƒ¥", "byu"}, {"ãƒ“ãƒ§", "byo"},

    // åŠæµŠéŸ³æ‹—éŸ³
    {"ã´ã‚ƒ", "pya"}, {"ã´ã‚…", "pyu"}, {"ã´ã‚‡", "pyo"},

    // ç‰‡å‡ååŠæµŠéŸ³æ‹—éŸ³
    {"ãƒ”ãƒ£", "pya"}, {"ãƒ”ãƒ¥", "pyu"}, {"ãƒ”ãƒ§", "pyo"},

    // âœ… é•¿éŸ³ï¼ˆå¹³å‡åï¼‰
    {"ã‚ãƒ¼", "aa"}, {"ã„ãƒ¼", "ii"}, {"ã†ãƒ¼", "uu"}, {"ãˆãƒ¼", "ee"}, {"ãŠãƒ¼", "oo"},
    {"ã‹ãƒ¼", "kaa"}, {"ããƒ¼", "kii"}, {"ããƒ¼", "kuu"}, {"ã‘ãƒ¼", "kee"}, {"ã“ãƒ¼", "koo"},
    {"ã•ãƒ¼", "saa"}, {"ã—ãƒ¼", "shii"}, {"ã™ãƒ¼", "suu"}, {"ã›ãƒ¼", "see"}, {"ããƒ¼", "soo"},
    {"ãŸãƒ¼", "taa"}, {"ã¡ãƒ¼", "chii"}, {"ã¤ãƒ¼", "tsuu"}, {"ã¦ãƒ¼", "tee"}, {"ã¨ãƒ¼", "too"},
    {"ãªãƒ¼", "naa"}, {"ã«ãƒ¼", "nii"}, {"ã¬ãƒ¼", "nuu"}, {"ã­ãƒ¼", "nee"}, {"ã®ãƒ¼", "noo"},
    {"ã¯ãƒ¼", "haa"}, {"ã²ãƒ¼", "hii"}, {"ãµãƒ¼", "fuu"}, {"ã¸ãƒ¼", "hee"}, {"ã»ãƒ¼", "hoo"},
    {"ã¾ãƒ¼", "maa"}, {"ã¿ãƒ¼", "mii"}, {"ã‚€ãƒ¼", "muu"}, {"ã‚ãƒ¼", "mee"}, {"ã‚‚ãƒ¼", "moo"},
    {"ã‚„ãƒ¼", "yaa"}, {"ã‚†ãƒ¼", "yuu"}, {"ã‚ˆãƒ¼", "yoo"},
    {"ã‚‰ãƒ¼", "raa"}, {"ã‚Šãƒ¼", "rii"}, {"ã‚‹ãƒ¼", "ruu"}, {"ã‚Œãƒ¼", "ree"}, {"ã‚ãƒ¼", "roo"},
    {"ã‚ãƒ¼", "waa"}, {"ã‚’ãƒ¼", "woo"},

    // âœ… é•¿éŸ³ï¼ˆç‰‡å‡åï¼‰
    {"ã‚¢ãƒ¼", "aa"}, {"ã‚¤ãƒ¼", "ii"}, {"ã‚¦ãƒ¼", "uu"}, {"ã‚¨ãƒ¼", "ee"}, {"ã‚ªãƒ¼", "oo"},
    {"ã‚«ãƒ¼", "kaa"}, {"ã‚­ãƒ¼", "kii"}, {"ã‚¯ãƒ¼", "kuu"}, {"ã‚±ãƒ¼", "kee"}, {"ã‚³ãƒ¼", "koo"},
    {"ã‚µãƒ¼", "saa"}, {"ã‚·ãƒ¼", "shii"}, {"ã‚¹ãƒ¼", "suu"}, {"ã‚»ãƒ¼", "see"}, {"ã‚½ãƒ¼", "soo"},
    {"ã‚¿ãƒ¼", "taa"}, {"ãƒãƒ¼", "chii"}, {"ãƒ„ãƒ¼", "tsuu"}, {"ãƒ†ãƒ¼", "tee"}, {"ãƒˆãƒ¼", "too"},
    {"ãƒŠãƒ¼", "naa"}, {"ãƒ‹ãƒ¼", "nii"},

};

// å­˜å‚¨å‡åå¯¹åº”çš„åˆ†æ•°
map<string, int> scoreMap;

// ç”Ÿæˆéšæœºé€‰é¡¹
vector<string> getOptions(string correctRomaji) {
    vector<string> options;
    options.push_back(correctRomaji);

    // è·å–æ‰€æœ‰ç½—é©¬éŸ³
    vector<string> allRomaji;
    for (auto &pair : kanaMap) {
        if (pair.second != correctRomaji) {
            allRomaji.push_back(pair.second);
        }
    }

    // éšæœºé€‰æ‹© 3 ä¸ªå¹²æ‰°é¡¹
    random_shuffle(allRomaji.begin(), allRomaji.end());
    for (int i = 0; i < 3; i++) {
        options.push_back(allRomaji[i]);
    }

    // æ‰“ä¹±é€‰é¡¹é¡ºåº
    random_shuffle(options.begin(), options.end());
    return options;
}

// æ˜¾ç¤ºé€‰é¡¹
void displayOptions(vector<string> &options) {
    for (int i = 0; i < options.size(); i++) {
        cout << i + 1 << ". " << options[i] << endl;
    }
}

// ä¸»è¦é€»è¾‘
void startGame() {
    srand(time(0));

    // åˆå§‹åŒ–åˆ†æ•°
    for (auto &pair : kanaMap) {
        scoreMap[pair.first] = 0;
    }

    while (!scoreMap.empty()) {
        // éšæœºé€‰æ‹©ä¸€ä¸ªå‡å
        auto it = scoreMap.begin();
        advance(it, rand() % scoreMap.size());
        string kana = it->first;
        string correctRomaji = kanaMap[kana];

        // æ˜¾ç¤ºé¢˜ç›®
        cout << "è¯·ä¸º [" << kana << "] é€‰æ‹©æ­£ç¡®çš„ç½—é©¬éŸ³ï¼š" << endl;
        vector<string> options = getOptions(correctRomaji);
        displayOptions(options);

        // è·å–ç”¨æˆ·è¾“å…¥
        int choice;
        cout << "è¯·è¾“å…¥é€‰é¡¹ç¼–å·ï¼š";
        cin >> choice;

        // æ£€æŸ¥è¾“å…¥æ˜¯å¦åˆæ³•
        if (choice < 1 || choice > 4) {
            cout << "æ— æ•ˆé€‰æ‹©ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚\n";
            continue;
        }

        // åˆ¤æ–­æ­£ç¡®ä¸å¦
        if (options[choice - 1] == correctRomaji) {
            cout << "âœ… æ­£ç¡®ï¼" << endl;
            scoreMap[kana]++;
        } else {
            cout << "âŒ é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š" << correctRomaji << endl;
            scoreMap[kana] = max(0, scoreMap[kana] - 1);
        }

        // å¦‚æœåˆ†æ•°è¾¾åˆ°5ï¼Œç§»é™¤
        if (scoreMap[kana] >= 2) {
            cout << "ğŸ‰ [" << kana << "] è¾¾æ ‡ï¼Œä¸å†å‡ºç°ï¼" << endl;
            scoreMap.erase(kana);
        }
    }

    cout << "ğŸŠ æ­å–œä½ ï¼Œå…¨éƒ¨éŸ³éƒ½è¾¾æ ‡äº†ï¼" << endl;
}

int main() {
    startGame();
    return 0;
}
